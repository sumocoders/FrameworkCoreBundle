# Using the breadcrumb

The breadcrumb is a nice way to indicate where a user is in the application.

## Manual breadcrumbs
Adding a breadcrumb is as simple as adding a `#[Breadcrumb()]` attribute.

Example: single
```php
#[Route('single', name:'single')]
#[Breadcrumb('single')]
public function __invoke(): Response
{
}
```

Example: attributes on the class
```php
#[Route('single', name:'single')]
#[Breadcrumb('single')]
class Controller
{
    public function __invoke(): Response
    {
    }
}
```

Adding multiple attributes will chain the breadcrumb.

Example: single > multiple
```php
#[Route('/single/multiple', name:'multiple')]
#[Breadcrumb('single')]
#[Breadcrumb('multiple')]
public function __invoke(): Response
{
}
```

When needed a route can be added to the breadcrumb.

Example: [single](#) > multiple
```php
#[Route('/single/multiple', name:'multiple')]
#[Breadcrumb('single', route:['name' => 'single'])]
#[Breadcrumb('multiple')]
public function __invoke(): Response
{
}
```
Route parameters are also supported, but can only accept fixed values so are less useful to build dynamic breadcrumbs.
```php
#[Route('/single/{foo}', name:'multiple')]
#[Breadcrumb('single', route:['name' => 'single', 'parameters' => ['foo' => 'bar']])]
public function __invoke(string $foo): Response
{
}
```

## Automated breadcrumbs
A breadcrumb trail can be generated by passing the name of another route to the attribute.

The parent route **must have a breadcrumb attribute as well**, as the chain is built by parsing and resolving the attribute in the given parent route.

Parents are always rendered as a link. Parameters of the parent route are copied from the base route and the current request.

Example: [books](#) > genres
```php
#[Route('/books', name:'books_overview')]
#[Breadcrumb('books')]
public function __invoke(): Response
{
}

#[Route('/books/genres', name:'genres_overview')]
#[Breadcrumb('genres', parent:['name' => 'books_overview'])]
public function __invoke(): Response
{
}
```

## Rendering parameters in the breadcrumb
You can reference the passed parameter in your breadcrumb by putting it between curly brackets in the breadcrumb title.

Example: Authors > whatever-you-pass-as-$name
```php
#[Route('/author/{name}')]
#[Breadcrumb('authors')]
#[Breadcrumb('{name}')]
public function __invoke(string $name): Response
{
}
```
When ParamConverters are used it's possible to use a property of the object as breadcrumb value.

Example: Books > Harry Potter
```php
#[Route('/book/{book}')]
#[Breadcrumb('books')]
#[Breadcrumb('{book.title}')]
public function __invoke(Book $book): Response
{
}
```

This also works with chained parent attributes, as long as the parameter names are still present in the route.

Example: J.K. Rowling > Harry Potter
```php
#[Route('/{author}', name:'author_detail')]
#[Breadcrumb('{author.name}')]
public function __invoke(Author $author): Response
{
}

// ! If we'd omit the /{author} from this route, this example would no longer work !
#[Route('/{author}/{book}', name:'book_detail')]
#[Breadcrumb('{book.title}', parent:['name' => 'author_detail'])]
public function __invoke(Author $author, Book $book): Response
{
}
```
If you reference a parent route with required parameters, and the required parameter cannot be resolved from the current request, an error will be thrown.

You can also supply parameters yourself, just like you would with a route, but this has the same drawbacks. You can only pass fixed values, which kind of defeats the purpose of building dynamic breadcrumbs. It is strongly recommended to **match your breadcrumbs to your URL structure**.
```php
#[Route('/{book}', name:'book_detail')]
#[Breadcrumb('{book.title}', parent:['name' => 'author_detail', 'parameters' => ['author' => 4]])]
public function __invoke(Author $author, Book $book): Response
{
}
```

Custom ParamConverters are **not** supported. Only basic Doctrine Entity -> ID will work out of the box.

## Translations
It's possible to use translations as these get translated in the template.

Example: Authors
```yaml
breadcrumb.authors: 'Authors'
```

```php
#[Route('/authors/{author}', name:'authors')]
#[Breadcrumb('breadcrumb.authors')]
public function book(Author $author): Response
{
}
```


It's also possible to add paramters to the translation.

```yaml
breadcrumb.authors: 'Author: %name%'
```

```php
#[Route('/authors/{author}', name:'authors')]
#[Breadcrumb('breadcrumb.authors', parameters: ['%name%' => 'author.name
public function book(Author $author): Response
{
}
```

## Full example
Auteurs > J.K. Rowling > Harry Potter

```php
#[Route('/author', name:'author_overview')]
#[Breadcrumb('authors')]
public function __invoke(): Response
{
}

#[Route('/author/{author}', name:'author_detail')]
#[Breadcrumb('{author.name}', parent:['name' => 'author_overview']))]
public function __invoke(Author $author): Response
{
}

#[Route('/{author}/{book}', name:'book_detail')]
#[Breadcrumb('{book.title}', parent:['name' => 'author_detail'])]
public function __invoke(Author $author, Book $book): Response
{
}
```

```yaml
authors: 'Auteurs'
```
